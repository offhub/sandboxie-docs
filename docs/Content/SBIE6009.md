# SBIE6009

**Message**

SBIE6009 The configuration %3 of box %2 requires an advanced supporter certificate.

**Severity**: Error (popup)

## Description

This popup error is shown when a box configuration requires an advanced supporter certificate (a higher privilege set than a normal supporter certificate). The configuration cannot be used unless a valid advanced certificate is present and active.

Advanced certificates are used to gate features that further relax sandbox isolation or enable privileged proxy operations. Examples include advanced encryption handling, network proxying, or other sensitive capabilities that the project reserves for supporters.

## Typical Causes

- The box configuration enables a feature that requires an advanced supporter certificate (for example, a feature flagged as `opt_enc`, `opt_net`, or other privileged options).
- No advanced certificate is installed, or the installed certificate is not active or lacks the required advanced option flags.
- The driver/service failed to detect or validate the installed certificate.

## Suggested Actions

1. Review the configuration mentioned in the message (`%3` is the configuration identifier) and disable features requiring an advanced certificate if you do not intend to supply one.
2. If you need the advanced features, obtain and install an advanced supporter certificate and ensure it is active and contains the required option flags.
3. Restart Sandboxie components (service and driver) after installing a certificate so the driver can detect the change.
4. If you believe the certificate is installed correctly but the message persists, enable driver/service tracing and examine certificate query results via logs for troubleshooting.

## Related Messages

- [SBIE6004](SBIE6004.md) — General supporter certificate required warning (grace period); 6009 specifically requires the advanced certificate variant.
- [SBIE6008](SBIE6008.md) — Configuration unusable without any supporter certificate.

## Implementation Notes and Footnotes

These notes point to the code paths that check certificates and emit certificate-related messages. They are intended for maintainers and advanced users; exact line numbers are omitted by request.

[ ^1 ]: The user-visible message text is defined in the project's message resources and shown as a popup when the driver/service decides the configuration needs an advanced certificate.

[ ^2 ]: The driver API remaps message codes 6004, 6008 and 6009 into a single handling path when popping up messages through `Api_LogMessage` (the code remaps these codes before calling the popup helper). This is why the UI treats these codes similarly while still distinguishing their intent.

[ ^3 ]: Certificate flags and state are exposed by the driver via `Api_QueryDriverInfo` (the driver exposes `Verify_CertInfo` state and option flags such as `opt_enc`, `opt_net`, etc.). These flags determine which feature bits are advertised and which configurations require certificates.

[ ^4 ]: When user-mode components (for example, the UserServer proxy handling EFS) detect missing or insufficient certificates, they log certificate errors (e.g., calling `SbieApi_LogMsgExt(..., 6004, ...)`). Those checks verify `CertInfo.active` and the specific option flag required for the feature (for example `CertInfo.opt_enc` for EFS proxying). A similar check influences the emission of 6009 for advanced-certificate-only features.

---

_See also_: [SBIE6004.md](SBIE6004.md), [SBIE6008.md](SBIE6008.md), [EnableEFS.md](EnableEFS.md)

